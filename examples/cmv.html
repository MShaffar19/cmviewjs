<html>
<head>


<style>

rect:hover
{
	opacity: 0.5;
}


div.tooltip {
	position: absolute;
	text-align: center;
	width: 60px;
	height: 15px;
	padding: 5px;
	font: 12px sans-serif;
	background: #FFDAB9;
	border: 0px;
	border-radius: 8px;
	pointer-events: none;
}

</style>

</head>

<body>
	<h1><i>Protein Contact Map</i></h1>
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<script src="ngl.dev.js"></script>
	<script type = "text/javascript" src = "cmsvg.js"></script>
	<script type = "text/javascript" src = "cmngl.js"></script>
	<script type = "text/javascript" src = "cmcontroller.js"></script>
	
	<div id = "container" style = "width:1400px; height: 900px">
		<div id="nglviewport" style="width:700px; height:700px; float: right;"></div>
		<div id="svgviewport" style="width:700px; height:700px; float: left;"></div>
		<p>Enter PDB ID to show contact map:</p>
		<div id="form">
			<form id ="frm1">
			PDB ID: <input type="text" name="pdbid" id="pdbid" value="1smt">
			</form>

			<form id ="frm2">
			Chain: <input type="text" name="chain" id="chain" value="A">
			</form>			

			<input id="submit" value="Submit" type="button">
		</div>
		<p>Protein contact map represents the distance between all possible amino acid residue pairs of a three-dimensional protein structure using a binary-dimensional matrix.</p>
	</div>

	





  
<script>

//<body bgcolor="#07C7EE">
var loadedtag = 0;

function pdbinput(){
	var x = document.getElementById('pdbid').value;
	var y = document.getElementById('chain').value;
	console.log(x);
	console.log("Chain: " + y);
	


	//svgurl
	//"http://localhost:8000/examples/5sx3.json"
	var str1 = "http://localhost:8000/examples/";
	var str2 = ".json";
	var svgurl = str1.concat(x);
	svgurl = svgurl.concat(str2);
	//svgurl = "http://localhost:8000/examples/1smt.json";
	console.log(svgurl);

	//nglurl
	//"rcsb://5sx3.mmtf"
	var str4 = "rcsb://";
	var str5 = ".mmtf";
	var nglurl = str4.concat(x);
	nglurl = nglurl.concat(str5);
	console.log(nglurl);




	if(loadedtag === 1){
		//d3.select("svg").remove();
		document.getElementById("svgviewport").innerHTML = "";
		document.getElementById("nglviewport").innerHTML = "";
	}


	var nglobj = new cmNgl("ngl1", "nglviewport", nglurl, y);
	var svgobj = new cmSvg("svg1", nglobj, svgurl);
	var cmcontroller = new cmController("cmctr1", svgobj, nglobj);	

	//svgobj.printdata();
	


	cmcontroller.ctloadngl();

	cmcontroller.ctloadcmsvg();

	loadedtag = 1;

	//console.log(nglobj.res1[0]);
}

var inputpdbbtn = document.getElementById('submit');
inputpdbbtn.addEventListener('click', pdbinput);











/*
var nglobj = new cmNgl("ngl1", "nglviewport", "rcsb://5sx3.mmtf");
var svgobj = new cmSvg("svg1", nglobj,"http://localhost:8000/examples/5sx3.json");
var cmcontroller = new cmController("cmctr1", svgobj, nglobj);

cmcontroller.ctloadngl();
cmcontroller.ctloadcmsvg();
*/

</script>



</body>
</html>