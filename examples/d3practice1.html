<html>
<head>

<style>

rect:hover
{
	opacity: 0.5;
}



</style>

</head>

<body>




  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="ngl.dev.js"></script>
  <script type = "text/javascript" src = "cmsvg.js"></script>
  <script type = "text/javascript" src = "cmngl.js"></script>

  <div id="viewport" style="width:500px; height:500px;"></div>
<script>








//NGL
var stage; 
var structurecomp;



/*
var loadngl = function(){
    stage = new NGL.Stage( "viewport" );
    //then(distancecal);
    stage.loadFile( "rcsb://1smt.mmtf", { defaultRepresentation: true } ).then( function( o ){

    structurecomp = o;

    console.log(structurecomp);
    //var atomPair = [ [9, 30] ];
    //structurecomp.addRepresentation( "distance", { atomPair: atomPair } );
    

	} );
        
}

document.addEventListener( "DOMContentLoaded", loadngl);

console.log(structurecomp);
*/



var nglobj = new nglClass("ngl1", "viewport");
nglobj.loadngl();

stage = nglobj.stage;
structurecomp = nglobj.structurecomp;

console.log(nglobj.structurecomp);
console.log(nglobj.test1);






var svgobj = new svgClass("svg1");
svgobj.loadsvg();




//d3 method:

/*
d3.json("http://localhost:8000/examples/tst4.json", function(data){
	

	var size = data.length1;
	var residue1 = data.residue1;
	var residue2 = data.residue2;
	var svgsize = 700;

	//console.log(size);
	//console.log(residue1[0]);

	
	var residueToSvg = d3.scaleLinear().domain([0,size]).range([0,svgsize]);
	var svgToResidue = d3.scaleLinear().domain([0,svgsize]).range([0,size]);

	var unit = svgsize/size;
	var unitround = Math.floor(unit);


	//creating svg
	var svgContainer = d3.select("body").append("svg")
										.attr("width", svgsize)
										.attr("height", svgsize);



	var residuerectdata = [];
	for(var k = 0; k < residue1.length; k++){
		residuerectdata.push([residue1[k], residue2[k]]);
		residuerectdata.push([residue2[k], residue1[k]]);
	}	

	var coordx;
	var coordy;
	var tag = 0;


	function mouseover(p){
		var tempx = p[0];
		var tempy = p[1];


		coordx = tempx;
		coordy = tempy;
		console.log(coordx);
		console.log(coordy);


		if(tag == 1){
		structurecomp.removeRepresentation(repr);
		
		}
		var atomPair = [[coordx,coordy]];
		repr = structurecomp.addRepresentation( "distance", { atomPair: atomPair } );
		tag = 1;
		stage.centerView();

	}



	var grayrectdata = [];
	//drawing many background gray rects

	
	for(var i = 0; i < size; i++){
		for(var j = 0; j < size; j++){	
			grayrectdata.push([i,j]);
		}
	}

	var rectsgray = svgContainer.append("g").attr("class", "gray");
	var rects = rectsgray.selectAll("rect").data(grayrectdata).enter().append("rect");
	var rectattr = rects.attr("x", function(d){return residueToSvg(d[0]);})
						.attr("y", function(d){return residueToSvg(d[1]);})
						.attr("height", svgsize)
						.attr("width", svgsize)
						.style("fill", "#eee");	

	
	//console.log(grayrectdata[1][0]);



	//drawing only one background gray rect
	
	/*grayrectdata.push([0,0]);
	var rectsgray = svgContainer.append("g").attr("class", "gray");
	var rects = rectsgray.selectAll("rect").data(grayrectdata).enter().append("rect");
	var rectattr = rects.attr("x", function(d){return residueToSvg(d[0]);})
						.attr("y", function(d){return residueToSvg(d[1]);})
						.attr("height", svgsize)
						.attr("width", svgsize)
						.style("fill", "#eee")
						.on("mouseover", mouseover);
	

	//drawing the blue residue rect
	var rects1blue = svgContainer.append("g").attr("class", "blue");
	var rects1 = rects1blue.selectAll("rect").data(residuerectdata).enter().append("rect");
	var rectattr1 = rects1.attr("x", function(d){return residueToSvg(d[0]);})
						  .attr("y", function(d){return residueToSvg(d[1]);})
						  .attr("height", unit)
						  .attr("width", unit)
						  .style("fill", "steelblue")
						  .on("mouseover", mouseover);
	
	
	

});
*/





















//previous method:



//Include the svg before using the following method
//<svg id="svgOne" width="700" height="700"></svg>

/*
var svgns = "http://www.w3.org/2000/svg";
var oReq = new XMLHttpRequest();
		var url = "http://localhost:8000/examples/tst4.json";


		oReq.open("GET", url);
		oReq.responseType = "json";
		oReq.send();

		oReq.onload = function() {
			var data = oReq.response;
			
			var size = data.length1;
			var residue1 = data.residue1;
			var residue2 = data.residue2;
			var canvaswidth = 700;
			var unit = canvaswidth/size;
			var unitround = Math.floor(unit);


			for(var i = 0; i < 700; i++){
				for(var j = 0; j < 700; j++){






					var rect = document.createElementNS(svgns, 'rect');
					rect.setAttributeNS(null, 'class', 'rectbgclass');
	        		rect.setAttributeNS(null, 'x', i*unit);
	        		rect.setAttributeNS(null, 'y', j*unit);
	        		rect.setAttributeNS(null, 'height', unitround);
	        		rect.setAttributeNS(null, 'width', unitround);
	        	//rect.setAttributeNS(null, 'fill', 'rgb(10,150,255)');
	        		rect.setAttributeNS(null, 'style', 'fill-opacity: 1; fill: #eee');
	        	//style="fill-opacity: 1; fill: rgb(255, 127, 14);"
	        		document.getElementById('svgOne').appendChild(rect);
        		}
			}


			
			for(var k = 0; k < residue1.length; k++){
			var num1 = residue1[k];
			var num2 = residue2[k];
			var rect = document.createElementNS(svgns, 'rect');
			rect.setAttributeNS(null, 'class', 'rectclass');
        	rect.setAttributeNS(null, 'x', num1*unit);
        	rect.setAttributeNS(null, 'y', num2*unit);
        	rect.setAttributeNS(null, 'height', unitround);
        	rect.setAttributeNS(null, 'width', unitround);
        	//rect.setAttributeNS(null, 'fill', 'rgb(10,150,255)');
        	rect.setAttributeNS(null, 'style', 'fill-opacity: 1; fill: rgb(214, 39, 40);');
        	//style="fill-opacity: 1; fill: rgb(255, 127, 14);"
        	document.getElementById('svgOne').appendChild(rect);


        	var rect = document.createElementNS(svgns, 'rect');
        	rect.setAttributeNS(null, 'class', 'rectclass');
        	rect.setAttributeNS(null, 'x', num2*unit);
        	rect.setAttributeNS(null, 'y', num1*unit);
        	rect.setAttributeNS(null, 'height', unitround);
        	rect.setAttributeNS(null, 'width', unitround);
        	//rect.setAttributeNS(null, 'fill', 'rgb(10,150,255)');
        	rect.setAttributeNS(null, 'style', 'fill-opacity: 1; fill: rgb(214, 39, 40);');
        	document.getElementById('svgOne').appendChild(rect);
			
		}

			
		
		};
*/	





</script>



</body>
</html>